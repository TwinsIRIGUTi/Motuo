<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>モツオポーカー</title>
  <style>
    body { font-family: sans-serif; text-align: center; background: #fffdee; }
    #game { display: none; }
    .card { display: inline-block; border: 1px solid #333; padding: 20px; margin: 5px; font-size: 2em; cursor: pointer; }
    .selected { background-color: yellow; }
    #wordList { max-width: 90%; margin: 1em auto; font-size: 1em; }
  </style>
</head>
<body>
  <h1 onclick="startGame()">モツオポーカー</h1>
  <div id="game">
    <div id="cards"></div>
    <button onclick="submitSelection()">決定</button>
    <div id="message"></div>
    <div>スコア: <span id="score">0</span></div>
    <div>ヒント残り: <span id="hint">3</span></div>
    <div>残りカード: <span id="deckCount">108</span></div>
    <div id="wordList"></div>
  </div>

  <script>
    const wordList = [
      "シロ", "シロシオ", "シロタレ", "シロミソ", "シロスヤキ", "シロナマ",
      "レバ", "レバシオ", "レバタレ", "レバミソ", "レバスヤキ", "レバボイル",
      "ガツ", "ガツシオ", "ガツタレ", "ガツミソ", "ガツスヤキ", "ガツナマ",
      "ナンコツ", "ナンコツシオ", "ナンコツタレ", "ナンコツミソ", "ナンコツスヤキ", "ナンコツナマ",
      "アブラ", "アブラシオ", "アブラタレ", "アブラスヤキ", "アブラミソ", "アブラナマ",
      "ハツ", "ハツシオ", "ハツミソ", "ハツスヤキ", "ハツナマ",
      "カシラ", "カシラシオ", "カシラミソ", "カシラタレ", "カシラスヤキ",
      "ビール", "ウメワリ", "ブドウワリ", "ウイスキー", "サイダー",
      "ツル", "ツルシオ", "ツルスヤキ", "ツルミソ", "ツルタレ",
      "シンキ", "タンナマ", "オシンコ", "ダイコン",
      "ホネ", "ツル", "ツインズ"
    ];

    document.getElementById("wordList").textContent = "単語一覧: " + wordList.join("、");

    const cardCharacters = [
      "シ", "ロ", "シ", "オ", "タ", "レ", "ミ", "ソ", "ス", "ヤ", "キ", "ナ",
      "レ", "バ", "ボ", "イ", "ル", "ガ", "ツ", "ナ", "ン", "コ", "ツ",
      "ア", "ブ", "ラ", "ハ", "ツ", "カ", "シ", "ラ", "ビ", "ー", "ル",
      "ウ", "メ", "ワ", "リ", "ド", "ウ", "ウ", "イ", "ス", "キ", "ー",
      "サ", "イ", "ダ", "ー", "ツ", "ル", "シ", "ン", "キ", "タ", "ン",
      "マ", "オ", "シ", "ン", "コ", "ダ", "イ", "ホ", "ネ", "ツ", "イ",
      "ン", "ズ"
    ];

    let deck = [...cardCharacters];
    while (deck.length < 120) {
      deck = deck.concat(cardCharacters);
    }
    deck = deck.slice(0, 120);
    deck = shuffle(deck);

    let hand = deck.splice(0, 12);
    let selected = [];
    let score = 0;
    let hintCount = 3;

    function startGame() {
      document.querySelector("#game").style.display = "block";
      renderHand();
      updateDeckCount();
    }

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function renderHand() {
      const container = document.getElementById("cards");
      container.innerHTML = "";
      hand.forEach((char, index) => {
        const div = document.createElement("div");
        div.className = "card";
        div.textContent = char;
        if (selected.includes(index)) div.classList.add("selected");
        div.onclick = () => {
          if (selected.includes(index)) {
            selected = selected.filter(i => i !== index);
          } else {
            selected.push(index);
          }
          renderHand();
        };
        container.appendChild(div);
      });
    }

    function submitSelection() {
      const selectedWord = selected.map(i => hand[i]).join("");
      const matchedWords = wordList.filter(word => selectedWord.includes(word));

      if (selected.length === 0) {
        replaceAllHand();
        showMessage("全カード交換しました");
      } else if (matchedWords.length > 0) {
        const longestMatch = matchedWords.reduce((a, b) => a.length > b.length ? a : b);
        if (longestMatch.length === selectedWord.length) {
          score += 10;
          document.getElementById("score").textContent = score;
          replaceMatchedCards();
          showMessage("成立！ +" + longestMatch);
        } else {
          showMessage("成立しない単語が含まれてます");
        }
      } else {
        replaceSelectedCards();
        showMessage("カードを交換しました");
      }

      selected = [];
      renderHand();
      updateDeckCount();
    }

    function replaceSelectedCards() {
      selected.forEach(i => {
        hand[i] = deck.length > 0 ? deck.shift() : "";
      });
    }

    function replaceMatchedCards() {
      selected.forEach(i => {
        hand[i] = deck.length > 0 ? deck.shift() : "";
      });
    }

    function replaceAllHand() {
      for (let i = 0; i < hand.length; i++) {
        hand[i] = deck.length > 0 ? deck.shift() : "";
      }
    }

    function showMessage(msg) {
      document.getElementById("message").textContent = msg;
    }

    function updateDeckCount() {
      document.getElementById("deckCount").textContent = deck.length;
    }
  </script>
</body>
</html>
